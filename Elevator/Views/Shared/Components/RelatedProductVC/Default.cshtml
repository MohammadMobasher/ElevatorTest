@model List<DataLayer.Entities.Product>

<div class="ho-section related-product-area pb-30">
    <div class="container">
        <div class="section-title">
            <h3>محصولات مرتبط</h3>
        </div>
        <div class="product-slider new-best-featured-slider slider-navigation-2">
            @foreach (var item in Model)
            {
            <div class="product-slider-col">
                <!-- Single Product -->
                @Html.Partial("_ProductIndexGeneral", item)
                <!--// Single Product -->
            </div>
            }


        </div>
    </div>
</div>

<script>
    $(function () {
        debugger;
        var productBoxes = $('.discountProduct');
        $.each(productBoxes, function (index, key) {
            var id = $(key).attr('data-id');
            debugger;
            $.get("/Product/CalculateDiscount", { id: id }, function (result) {
                if (result !== false) {
                    debugger;
                    console.log(result);
                    $(key).append('<li class="flag-discount">' + result.item2 + "  " + (result.item3 == 1 ? "% تخفیف" : "تومان تخفیف") + '</li>');
                    $('.dicountValue_' + id).addClass("discount");
                    $('.dicountValue_' + id).html(result.item2 + "  " + (result.item3 == 1 ? "%" : "تومان تخفیف"));
                    $('.DiscountPrice_' + id).html(result.item1 + " تومان تخفیف");
                    $('.countdown_Id_' + id).html('<div class="hoproduct-countdown countdown" data-countdown="' + result.item4 + '"></div>');
                }
                else {
                    //$('.olPrice_' + id).css('display','none');
                }
            })

        })

    })

    $(function () {
        $('.VisitCounter').on('click', function () {
            var id = $(this).attr('data-id');
            $.get("/Product/AddVisit", { id: id }, function () { });
        })
    })
</script>